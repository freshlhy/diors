<!DOCTYPE HTML>
<html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<head>
	<base id="relR" href="../index.html"></base>
	<script>(function(){var l = location.href.replace(/#.*$/,''); if(/\.\w+$/.test(l)) l = l.replace(/[^\/]+$/, ''); var b = document.getElementById('relR'); b.href = l + b.getAttribute('href')})()
	</script>
	<title>屌丝指数</title>
</head>
<body id="page-body-c/shi-mao-zhi-test" class="default">
	<div id="headarea">
		<h1 id="pageTitle">
			屌丝指数
		</h1>
	</div>
	<div id="contents">
		<article><!-- !!Nagisa!BE!! -->
			<p>点进全文做测试。</p>
			<!-- !!Nagisa!FI!! -->

			<div id="questions"></div>
			<div id="score">您的屌丝指数 <strong id="scoreMarks">0</strong></div>
			<style>
			#questions .hideChild ol {display: none}
			#questions>ol{font-weight:bold}
			#questions>ol ol{font-weight:normal}
			#score {position: fixed; left: 17.5em;top:5em;font-size:2em;text-align:center;border:1px solid #ddd;padding:0.2em;width:7em}
			#score #scoreMarks{display:block;font-size:1.5em;}
			#score .err {color:red}
			</style>
			<script>
			var questions = {
				"男女有别" : {
					__childrenExclusive: true,
					"男":	{
						__base: 0,
						"身上现金不超过1000元":	+128,
						"喝康师傅绿茶":	+64,
						"三五年没长途旅游":	+64,
						"穿真维斯":	+64,
						"婚前女友不超过三个": +64,
						"开10万元以下的车":	+32,
						"抽二十元一下的烟":	+32,
						"只喝白酒和啤酒": +32
					},
					"女": {
						__base: 0,
						"从没买过比基尼":	+128,
						"不会穿成套内衣裤":	+64,
						"从不穿9厘米以上的鞋":	+64,
						"没有亮色指甲油":	+64,
						"五个月以上都在减肥":	+64,
						"超过半年没换过发型":	+64,
						"喜欢走在男人后面":	+32,
						"超过半年没换过发型":	+32,
						"不太爱照镜子":	+32,
						"不敢咧嘴大笑":	+32,
					}
				},
				"成长":{
					"出生":{
						"贫寒之家":{
							__childrenExclusive: true,
							"__base": +16,
							"农村":	+64,
							"小城市底层小市民家庭":	+32,
						},
						"学历":{
							__childrenExclusive: true,
							"初中即辍学": {
								__childrenExclusive: true,
								"__base": +16,
								"进城务工":	+16,
								"餐厅服务员": +16,
								"网吧网管": +25,
								"无业游民": +64,
								"做了小老板": -180,
							},
							"十二载寒窗考上大学": {
								"__base": -16,
								"攻读理工科专业": +16
							},
						},
					},
					"生活":{
						"最爱网游":	+72,
						"经常上贴吧": +64,
						"更爱“女神”爱幻想":	+64,
					},
					"爱情":{
						"一片空白或者充满坎坷": +80,
						"经常在网络上发泄不满":	+80,
						"在心爱的姑娘面前自觉形秽":	+160,
						"当心仪的姑娘和别人牵手时，恨世道的不公正也恨自己的不争气。": +128
					},
				},
				"工作" :{
					"月薪不超过3500": +16,
					"年终福利不超过1万": +16
				},
				"未来" : {
					"定一些过高的目标":	+64
				},
				"健康" : {
					"定一些过高的目标":	+64
				},
				"路线" : {
					"定一些过高的目标":	+64
				},
				"杀手" : {
					"每天不吃早餐。屌丝哪里吃得起早餐啊！":	+64,
					"每天对电脑十二小时以上。屌丝除了对着电脑还能干嘛？":	+64,
					"凌晨零点以后睡觉。屌丝每天搬砖不到深夜敢睡觉？":	+64,
					"缺乏必要的体育锻炼，面黄肌瘦，身材矮小。这点是毫无疑问的。":	+64,
					"每天不吃早餐。屌丝哪里吃得起早餐啊！":	+64,
					"每天不吃早餐。屌丝哪里吃得起早餐啊！":	+64,
					"白天和晚上的时间颠倒。":	+64				
				},
				"性格" : {
					"定一些过高的目标":	+64
				},
				"情操" : {
					
				},
				"日常表现" : {
					"定一些过高的目标":	+64
				},
				"屌丝看自己" : {
					"穷丑矮胖矬笨，撸！": +64,
					"特别渴望做白富美的狗，跪在白富美脚下磕头舔鞋。": +64,
					"女神的备胎，甚至连备胎都不是，只是一个默默的千斤顶。": +64,
					"被人打了只能装死，想不开就去死。": +64,
					"永无翻身之日。": +64,
					"屌丝们内心还是非常渴望成功的。": +64,
					"屌丝不敢进入高档的美发屋和装修华丽的地方，进个星巴克手都不知道放哪好。": +64,
					"屌丝们似乎在宣称：反正我就是这么副屌样，再怎么差都无所谓了。": +64,
					"屌丝们的一日三餐都尽可能的精简成本，偶尔吃一顿烧烤简直是奢侈。": +64,
					"穷，是屌丝最显著的特征，有房、有车、有娘子对于他们来说就是痴人说梦，就算实现，也是在许多许多年以后。": +64
				}
			}
			function createCheckedTree(tree) {
				var ans = {};
				for(var key in tree) {
					if(typeof tree[key] === 'number' || typeof tree[key] === 'string') {
						ans[key] = false
					} else {
						ans[key] = createCheckedTree(tree[key])
					}
				}
				return ans;
			}
			var checked = createCheckedTree(questions);

			function calculateNodeScore(node, cnode){
				var score = 0;
				if('__base' in node){
					if(cnode.__base) score += node.__base
						else return 0
					}
				for(var key in node) if(!/^__/.test(key)) {
					if(typeof(node[key]) === 'number') {
						if(cnode[key]) score += node[key]
					} else if(typeof(node[key]) === 'string') {
						if(cnode[key]) throw (node[key])
					} else {
						score += calculateNodeScore(node[key], cnode[key]);
					}
				};
				return score;
			}
			function recalculateScore() {
				for(var j = 0; j < checkFunctions.length; j++){
					checkFunctions[j]();
				}
				var score = 0;
				try {
					score = calculateNodeScore(questions, checked);
					document.getElementById('scoreMarks').innerHTML = ('' + score).replace(/-/g, '\u2212');
				} catch (e) {
					document.getElementById('scoreMarks').innerHTML = '<span class="err">' + e + '</span>';
				}
			};
			var checkFunctions = []
			var groupid = 0;
			function createDOMTree(tree, container){
				var ol = document.createElement("ol");
				container.appendChild(ol);
				var gid = groupid++;
				var childrenInputType = tree.__childrenExclusive ? 'radio' : 'checkbox'
				for(var key in tree) if(!/^__/.test(key)){
					var subtree = tree[key];	
					if(typeof(subtree) === 'boolean') {
						// common node
						(function(t, k){
							var li = document.createElement('li');
							ol.appendChild(li);
							var label = document.createElement('label');
							li.appendChild(label);
							var checkbox = document.createElement('input');
							checkbox.type = childrenInputType;
							checkbox.name = 'g' + gid;
							checkFunctions.push(function(){
								t[k] = checkbox.checked;
							})
							label.appendChild(checkbox);
							label.appendChild(document.createTextNode(k));
							checkbox.onchange = function(){
								recalculateScore();
							}
						})(tree, key);
					} else {
						var li = document.createElement('li');
						ol.appendChild(li);
						// node with subtree
						if('__base' in subtree){
							(function(t, k, li, displayKey){
								var label = document.createElement('label');
								li.appendChild(label);
								var checkbox = document.createElement('input');
								checkbox.type = childrenInputType;
								checkbox.name = 'g' + gid;
								checkFunctions.push(function(){
									li.className = (checkbox.checked ? 'showChild' : 'hideChild');
									t[k] = checkbox.checked;
								});
								label.appendChild(checkbox);
								label.appendChild(document.createTextNode(displayKey));
								checkbox.onchange = function(){
									recalculateScore()
								};
								li.className = 'hideChild'
							})(subtree, '__base', li, key)
						} else {
							li.appendChild(document.createTextNode(key))
						};
						createDOMTree(subtree, li);
					}
				};
				container.appendChild(ol);
			};
			createDOMTree(checked, document.getElementById('questions'))
			</script>

			<!-- !!Nagisa!FI!! -->
		</article>
		<!-- <div class="page-index"><a href="c/shi-mao-zhi-test.html#headarea" class="top"><span>Top</span></a></div> -->
	</div>
	<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-40775393-1', '73471.com');
	ga('send', 'pageview');

	</script>
</body>
</html>
